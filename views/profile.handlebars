{{> messages}}

<main id="profile-page">
  <h1>Welcome to your profile page, {{user.username}}!</h1>

  <section aria-labelledby="reviews-heading">
    <h2 id="reviews-heading">Your Reviews</h2>
    {{#if reviews.length}}
      <ul>
        {{#each reviews}}
          <li>
            <div>
              <p><strong>Movie:</strong> {{this.movie.title}}</p>
              <p><strong>Comment:</strong> "{{this.comment}}"</p>
              <p><strong>Rating:</strong> {{this.rating}}</p>
            </div>
            <form action="/profile/review/{{this._id}}" method="POST" onsubmit="return confirm('Are you sure you want to delete this review?')">
              <button type="submit" aria-label="Delete review for {{this.movie.title}}">Delete</button>
            </form>
          </li>
        {{/each}}
      </ul>
    {{else}}
      <p>You haven't written any reviews yet.</p>
    {{/if}}
  </section>

  <section id="changePassword" aria-labelledby="change-password-heading">
    <h2 id="change-password-heading">Change Password</h2>
    <form method="POST" action="/auth/change-password">
        <label for="currentPassword">Current Password</label>
        <input type="password" name="currentPassword" id="currentPassword" placeholder="Current Password" required>
        <label for="newPassword">New Password</label>
        <input type="password" name="newPassword" id="newPassword" placeholder="New Password" required>
        <label for="confirmPassword">Confirm Password</label>
        <input type="password" name="confirmPassword" id="confirmPassword" placeholder="Confirm Password" required>
        <button type="submit" aria-label="Confirm password change">Change password</button>
    </form>
  </section>

  <section id="deleteUser" aria-labelledby="delete-user-heading">
    <h2 id="delete-user-heading">Delete Your Account</h2>
    <form action="/profile/delete" method="POST">
      <div class="input-row">
        <label for="password">Confirm your password:</label>
        <input type="password" name="password" id="password" placeholder="Password" required>
      </div>
      <button type="submit" aria-label="Confirm deleting your account">Delete Account</button>
    </form>
  </section>
</main>
